version 15: updated the world generation logic